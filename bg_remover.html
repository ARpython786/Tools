<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Professional online tool to remove backgrounds from images with pixel-perfect precision. Free, fast, and works directly in your browser.">
    <meta name="keywords" content="background remover, transparent background, image editor, photo editing, remove bg">
    <title>ProBG Remover | Professional Image Background Removal Tool</title>
    <style>
        /* CSS Reset and Base Styles */
        :root {
            --primary-color: #4361ee;
            --primary-dark: #3a56d4;
            --secondary-color: #3f37c9;
            --accent-color: #4895ef;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --gray-color: #6c757d;
            --success-color: #4bb543;
            --warning-color: #f0ad4e;
            --error-color: #d9534f;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-color);
            background-color: #f5f7fa;
            overflow-x: hidden;
        }

        /* Header Styles */
        header {
            background-color: white;
            box-shadow: var(--box-shadow);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--primary-color);
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
        }

        .ad-container {
            min-height: 90px;
            min-width: 728px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px dashed #ccc;
        }

        /* Main Content Styles */
        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
        }

        @media (max-width: 768px) {
            main {
                grid-template-columns: 1fr;
            }
        }

        /* Upload Section */
        .upload-section {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .upload-container {
            border: 2px dashed var(--gray-color);
            border-radius: var(--border-radius);
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-container:hover {
            border-color: var(--primary-color);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .upload-container.active {
            border-color: var(--primary-color);
            background-color: rgba(67, 97, 238, 0.1);
        }

        .upload-icon {
            width: 64px;
            height: 64px;
            margin-bottom: 1rem;
            color: var(--gray-color);
        }

        .upload-title {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .upload-subtitle {
            color: var(--gray-color);
            margin-bottom: 1rem;
        }

        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: white;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background-color: rgba(67, 97, 238, 0.1);
        }

        .btn-disabled {
            background-color: var(--gray-color);
            cursor: not-allowed;
        }

        .btn-disabled:hover {
            transform: none;
            background-color: var(--gray-color);
        }

        /* Preview Section */
        .preview-section {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .preview-title {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary-color);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .preview-container {
            position: relative;
            width: 100%;
            height: 400px;
            border: 1px solid #eee;
            border-radius: var(--border-radius);
            overflow: hidden;
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AkEEjIZFQpIYQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAJUlEQVQ4y2NgGAWjYBSMglEwCkbBKBgY8D8QbQzEwQZGAQMAJXQBZ1ZtB3QAAAAASUVORK5CYII=');
            background-repeat: repeat;
            margin-bottom: 1rem;
        }

        .canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        canvas {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .preview-slider {
            width: 100%;
            height: 40px;
            position: relative;
            margin-bottom: 1rem;
        }

        .slider-track {
            width: 100%;
            height: 4px;
            background-color: #ddd;
            border-radius: 2px;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
        }

        .slider-thumb {
            width: 20px;
            height: 20px;
            background-color: var(--primary-color);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            cursor: grab;
        }

        .slider-thumb:active {
            cursor: grabbing;
        }

        /* Tools Section */
        .tools-section {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 2rem;
        }

        .tools-title {
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }

        .tool-group {
            margin-bottom: 1.5rem;
        }

        .tool-group-title {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--gray-color);
            display: flex;
            justify-content: space-between;
        }

        .tool-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
        }

        .tool-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.75rem;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .tool-btn:hover {
            border-color: var(--primary-color);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .tool-btn.active {
            border-color: var(--primary-color);
            background-color: rgba(67, 97, 238, 0.1);
        }

        .tool-icon {
            width: 24px;
            height: 24px;
            margin-bottom: 0.5rem;
            color: var(--gray-color);
        }

        .tool-btn.active .tool-icon {
            color: var(--primary-color);
        }

        .tool-label {
            font-size: 0.875rem;
            text-align: center;
        }

        .slider-container {
            margin-bottom: 1rem;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .range-slider {
            width: 100%;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: #ddd;
            border-radius: 2px;
            outline: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
        }

        .range-slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* Sidebar Styles */
        aside {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .sidebar-section {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 1.5rem;
        }

        .sidebar-title {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--dark-color);
        }

        .tips-list {
            list-style-type: none;
        }

        .tips-list li {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .tips-list li:before {
            content: "•";
            color: var(--primary-color);
            font-size: 1.5rem;
            position: absolute;
            left: 0;
            top: -2px;
        }

        .sidebar-ad {
            min-height: 250px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px dashed #ccc;
        }

        /* Footer Styles */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 2rem;
            margin-top: 3rem;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: white;
            text-decoration: none;
            margin-bottom: 1rem;
        }

        .footer-logo-icon {
            width: 24px;
            height: 24px;
        }

        .footer-description {
            color: #adb5bd;
            margin-bottom: 1rem;
        }

        .footer-links-title {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: white;
        }

        .footer-links {
            list-style-type: none;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: #adb5bd;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: white;
        }

        .footer-bottom {
            max-width: 1200px;
            margin: 2rem auto 0;
            padding-top: 1rem;
            border-top: 1px solid #495057;
            display: flex;
            justify-content: space-between;
            color: #adb5bd;
            font-size: 0.875rem;
        }

        /* Loading Indicator */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: var(--transition);
        }

        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            margin-top: 1rem;
            text-align: center;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--dark-color);
            color: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            transform: translateY(100px);
            opacity: 0;
            transition: var(--transition);
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            background-color: var(--success-color);
        }

        .toast.error {
            background-color: var(--error-color);
        }

        .toast.warning {
            background-color: var(--warning-color);
        }

        /* Responsive Adjustments */
        @media (max-width: 992px) {
            .header-container {
                flex-direction: column;
                gap: 1rem;
            }

            .ad-container {
                min-width: 100%;
                min-height: 60px;
            }
        }

        @media (max-width: 768px) {
            .upload-container {
                padding: 1.5rem;
            }

            .preview-container {
                height: 300px;
            }

            .action-buttons {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            header {
                padding: 1rem;
            }

            .upload-section, .preview-section, .tools-section, .sidebar-section {
                padding: 1.5rem;
            }

            .preview-container {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="header-container">
            <a href="#" class="logo" aria-label="ProBG Remover Home">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 8L8 4M8 4L12 8M8 4V16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M20 16L16 20M16 20L12 16M16 20V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                ProBG Remover
            </a>
            <div class="ad-container" aria-label="Advertisement">
                <!-- Insert AdSense Code Here -->
                Advertisement
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <article>
            <!-- Upload Section -->
            <section class="upload-section" aria-labelledby="upload-title">
                <h2 id="upload-title" class="visually-hidden">Upload Image</h2>
                <div class="upload-container" id="uploadContainer" tabindex="0" role="button" aria-label="Upload image">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M17 8L12 3L7 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 3V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <h3 class="upload-title">Drag & Drop Your Image Here</h3>
                    <p class="upload-subtitle">or click to browse files (PNG, JPG, JPEG up to 10MB)</p>
                    <button class="btn" id="uploadBtn">Select Image</button>
                    <input type="file" id="fileInput" accept="image/png, image/jpeg, image/jpg" style="display: none;">
                </div>
            </section>

            <!-- Preview Section -->
            <section class="preview-section" aria-labelledby="preview-title" style="display: none;" id="previewSection">
                <div class="preview-title">
                    <h2 id="preview-title">Preview</h2>
                    <div class="preview-toggle">
                        <span>Original</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="previewToggle">
                            <span class="toggle-slider"></span>
                        </label>
                        <span>Result</span>
                    </div>
                </div>
                <div class="preview-container">
                    <div class="canvas-container">
                        <canvas id="originalCanvas"></canvas>
                        <canvas id="resultCanvas" style="display: none;"></canvas>
                    </div>
                </div>
                <div class="preview-slider" style="display: none;" id="previewSlider">
                    <div class="slider-track"></div>
                    <div class="slider-thumb" id="sliderThumb"></div>
                </div>
            </section>

            <!-- Tools Section -->
            <section class="tools-section" aria-labelledby="tools-title" style="display: none;" id="toolsSection">
                <h2 id="tools-title">Refinement Tools</h2>
                
                <div class="tool-group">
                    <h3 class="tool-group-title">Selection Tools</h3>
                    <div class="tool-options">
                        <button class="tool-btn" id="keepTool" aria-label="Keep tool">
                            <svg class="tool-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M8 12L11 15L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span class="tool-label">Keep</span>
                        </button>
                        <button class="tool-btn" id="removeTool" aria-label="Remove tool">
                            <svg class="tool-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span class="tool-label">Remove</span>
                        </button>
                        <button class="tool-btn" id="brushTool" aria-label="Brush tool">
                            <svg class="tool-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20.71 4.04L19.96 3.29C19.5784 2.90733 19.0083 2.75422 18.48 2.88L12 4L19 11L20.12 5.52C20.2533 4.99166 20.0927 4.42158 19.71 4.04H20.71Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M11 13L9 21L5 17L11 13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M13 11L17 7L13 3L9 7L13 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span class="tool-label">Brush</span>
                        </button>
                        <button class="tool-btn" id="eraserTool" aria-label="Eraser tool">
                            <svg class="tool-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M7 21H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M15.5 7.5L11 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M13 15L8.5 10.5L3 16C2 17 2.5 18.5 4 19C5.5 19.5 7 19 8 18L13 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 7.5L16.5 3C17.5 2 19 2.5 19.5 4C20 5.5 19.5 7 18.5 8L14 12.5L12 7.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span class="tool-label">Eraser</span>
                        </button>
                    </div>
                </div>

                <div class="tool-group">
                    <h3 class="tool-group-title">Brush Settings</h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Size</span>
                            <span id="brushSizeValue">20</span>
                        </div>
                        <input type="range" min="1" max="100" value="20" class="range-slider" id="brushSizeSlider">
                    </div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Hardness</span>
                            <span id="brushHardnessValue">80%</span>
                        </div>
                        <input type="range" min="0" max="100" value="80" class="range-slider" id="brushHardnessSlider">
                    </div>
                </div>

                <div class="tool-group">
                    <h3 class="tool-group-title">Edge Refinement</h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Smoothness</span>
                            <span id="smoothnessValue">50%</span>
                        </div>
                        <input type="range" min="0" max="100" value="50" class="range-slider" id="smoothnessSlider">
                    </div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Feather</span>
                            <span id="featherValue">10%</span>
                        </div>
                        <input type="range" min="0" max="100" value="10" class="range-slider" id="featherSlider">
                    </div>
                </div>

                <div class="tool-group">
                    <h3 class="tool-group-title">Advanced</h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Tolerance</span>
                            <span id="toleranceValue">30%</span>
                        </div>
                        <input type="range" min="0" max="100" value="30" class="range-slider" id="toleranceSlider">
                    </div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Contrast</span>
                            <span id="contrastValue">20%</span>
                        </div>
                        <input type="range" min="0" max="100" value="20" class="range-slider" id="contrastSlider">
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" id="undoBtn" disabled aria-label="Undo last action">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 15H12C14.1217 15 16.1566 14.1571 17.6569 12.6569C19.1571 11.1566 20 9.12173 20 7C20 4.87827 19.1571 2.84344 17.6569 1.34315C16.1566 -0.157145 14.1217 -1 12 -1C9.87827 -1 7.84344 -0.157145 6.34315 1.34315C5.26829 2.41802 4.58835 3.82243 4.3999 5.33333" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M3 8L5.33333 5.33333L8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Undo
                    </button>
                    <button class="btn btn-secondary" id="redoBtn" disabled aria-label="Redo last action">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 15H12C9.87827 15 7.84344 14.1571 6.34315 12.6569C4.84285 11.1566 4 9.12173 4 7C4 4.87827 4.84285 2.84344 6.34315 1.34315C7.84344 -0.157145 9.87827 -1 12 -1C14.1217 -1 16.1566 -0.157145 17.6569 1.34315C18.7317 2.41802 19.4117 3.82243 19.6001 5.33333" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M21 8L18.6667 5.33333L16 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Redo
                    </button>
                    <button class="btn btn-secondary" id="resetBtn" aria-label="Reset image">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 22C14 22 14.5 21.5 14.5 17.5C14.5 13.5 14 10 14 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M10 2C10 2 9.5 2.5 9.5 6.5C9.5 10.5 10 14 10 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M18 8C18 8 20 9 20 12C20 15 18 16 18 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 16C6 16 4 15 4 12C4 9 6 8 6 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 20C2 20 4 22 6 22C8 22 14 22 14 22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M22 4C22 4 20 2 18 2C16 2 10 2 10 2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Reset
                    </button>
                    <button class="btn" id="downloadBtn" aria-label="Download image">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 15V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Download PNG
                    </button>
                </div>
            </section>
        </article>

        <!-- Sidebar -->
        <aside>
            <section class="sidebar-section" aria-labelledby="tips-title">
                <h2 id="tips-title" class="sidebar-title">Tips for Best Results</h2>
                <ul class="tips-list">
                    <li>Use high-quality, well-lit images for best results</li>
                    <li>For complex edges (hair, fur), use the brush tool to refine</li>
                    <li>Adjust tolerance for better edge detection</li>
                    <li>Use the preview slider to compare before/after</li>
                    <li>Zoom in for detailed refinements</li>
                </ul>
            </section>

            <section class="sidebar-section" aria-labelledby="watermark-title">
                <h2 id="watermark-title" class="sidebar-title">Watermark Settings</h2>
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Opacity</span>
                        <span id="watermarkOpacityValue">50%</span>
                    </div>
                    <input type="range" min="0" max="100" value="50" class="range-slider" id="watermarkOpacitySlider">
                </div>
                <div style="margin-top: 1rem;">
                    <label for="watermarkText" class="visually-hidden">Watermark Text</label>
                    <input type="text" id="watermarkText" placeholder="Enter watermark text" class="input-field" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: var(--border-radius);">
                </div>
                <div style="margin-top: 1rem;">
                    <label class="toggle-switch" style="display: flex; align-items: center; gap: 0.5rem;">
                        <input type="checkbox" id="watermarkToggle">
                        <span class="toggle-slider"></span>
                        <span>Enable Watermark</span>
                    </label>
                </div>
            </section>

            <div class="sidebar-ad" aria-label="Advertisement">
                <!-- Insert AdSense Code Here -->
                Advertisement
            </div>
        </aside>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div>
                <a href="#" class="footer-logo">
                    <svg class="footer-logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 8L8 4M8 4L12 8M8 4V16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M20 16L16 20M16 20L12 16M16 20V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    ProBG Remover
                </a>
                <p class="footer-description">
                    Professional online tool to remove backgrounds from images with pixel-perfect precision. Free, fast, and works directly in your browser.
                </p>
            </div>
            <div>
                <h3 class="footer-links-title">Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">How It Works</a></li>
                    <li><a href="#">Examples</a></li>
                    <li><a href="#">Pricing</a></li>
                    <li><a href="#">API</a></li>
                </ul>
            </div>
            <div>
                <h3 class="footer-links-title">Resources</h3>
                <ul class="footer-links">
                    <li><a href="#">Help Center</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Tutorials</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                </ul>
            </div>
            <div>
                <h3 class="footer-links-title">Connect</h3>
                <ul class="footer-links">
                    <li><a href="#">Contact Us</a></li>
                    <li><a href="#">Twitter</a></li>
                    <li><a href="#">Facebook</a></li>
                    <li><a href="#">Instagram</a></li>
                    <li><a href="#">GitHub</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <span>&copy; 2023 ProBG Remover. All rights reserved.</span>
            <span>Made with ❤️ for creators</span>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div>
            <div class="loading-spinner"></div>
            <p class="loading-text" id="loadingText">Processing your image...</p>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Hidden Canvas for Processing -->
    <canvas id="hiddenCanvas" style="display: none;"></canvas>

    <script>
        // Main Application Class
        class BackgroundRemover {
            constructor() {
                // DOM Elements
                this.uploadContainer = document.getElementById('uploadContainer');
                this.uploadBtn = document.getElementById('uploadBtn');
                this.fileInput = document.getElementById('fileInput');
                this.previewSection = document.getElementById('previewSection');
                this.toolsSection = document.getElementById('toolsSection');
                this.originalCanvas = document.getElementById('originalCanvas');
                this.resultCanvas = document.getElementById('resultCanvas');
                this.previewToggle = document.getElementById('previewToggle');
                this.previewSlider = document.getElementById('previewSlider');
                this.sliderThumb = document.getElementById('sliderThumb');
                this.hiddenCanvas = document.getElementById('hiddenCanvas');
                this.undoBtn = document.getElementById('undoBtn');
                this.redoBtn = document.getElementById('redoBtn');
                this.resetBtn = document.getElementById('resetBtn');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.loadingOverlay = document.getElementById('loadingOverlay');
                this.loadingText = document.getElementById('loadingText');
                this.toast = document.getElementById('toast');
                
                // Tool Elements
                this.keepTool = document.getElementById('keepTool');
                this.removeTool = document.getElementById('removeTool');
                this.brushTool = document.getElementById('brushTool');
                this.eraserTool = document.getElementById('eraserTool');
                
                // Slider Elements
                this.brushSizeSlider = document.getElementById('brushSizeSlider');
                this.brushSizeValue = document.getElementById('brushSizeValue');
                this.brushHardnessSlider = document.getElementById('brushHardnessSlider');
                this.brushHardnessValue = document.getElementById('brushHardnessValue');
                this.smoothnessSlider = document.getElementById('smoothnessSlider');
                this.smoothnessValue = document.getElementById('smoothnessValue');
                this.featherSlider = document.getElementById('featherSlider');
                this.featherValue = document.getElementById('featherValue');
                this.toleranceSlider = document.getElementById('toleranceSlider');
                this.toleranceValue = document.getElementById('toleranceValue');
                this.contrastSlider = document.getElementById('contrastSlider');
                this.contrastValue = document.getElementById('contrastValue');
                this.watermarkOpacitySlider = document.getElementById('watermarkOpacitySlider');
                this.watermarkOpacityValue = document.getElementById('watermarkOpacityValue');
                this.watermarkToggle = document.getElementById('watermarkToggle');
                this.watermarkText = document.getElementById('watermarkText');
                
                // Application State
                this.state = {
                    originalImage: null,
                    processedImage: null,
                    maskData: null,
                    canvasSize: { width: 0, height: 0 },
                    activeTool: null,
                    brushSize: 20,
                    brushHardness: 80,
                    tolerance: 30,
                    contrast: 20,
                    smoothness: 50,
                    feather: 10,
                    history: [],
                    historyIndex: -1,
                    watermark: {
                        enabled: false,
                        text: 'ProBG Remover',
                        opacity: 50
                    }
                };
                
                // Initialize the application
                this.init();
            }
            
            init() {
                // Event Listeners
                this.setupEventListeners();
                
                // Initialize tools
                this.setActiveTool('brush');
            }
            
            setupEventListeners() {
                // Upload Events
                this.uploadContainer.addEventListener('click', () => this.fileInput.click());
                this.uploadContainer.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    this.uploadContainer.classList.add('active');
                });
                this.uploadContainer.addEventListener('dragleave', () => {
                    this.uploadContainer.classList.remove('active');
                });
                this.uploadContainer.addEventListener('drop', (e) => {
                    e.preventDefault();
                    this.uploadContainer.classList.remove('active');
                    if (e.dataTransfer.files.length) {
                        this.handleFileUpload(e.dataTransfer.files[0]);
                    }
                });
                this.fileInput.addEventListener('change', () => {
                    if (this.fileInput.files.length) {
                        this.handleFileUpload(this.fileInput.files[0]);
                    }
                });
                this.uploadBtn.addEventListener('click', () => this.fileInput.click());
                
                // Preview Toggle
                this.previewToggle.addEventListener('change', () => {
                    if (this.previewToggle.checked) {
                        this.originalCanvas.style.display = 'none';
                        this.resultCanvas.style.display = 'block';
                    } else {
                        this.originalCanvas.style.display = 'block';
                        this.resultCanvas.style.display = 'none';
                    }
                });
                
                // Preview Slider
                this.setupPreviewSlider();
                
                // Tool Selection
                this.keepTool.addEventListener('click', () => this.setActiveTool('keep'));
                this.removeTool.addEventListener('click', () => this.setActiveTool('remove'));
                this.brushTool.addEventListener('click', () => this.setActiveTool('brush'));
                this.eraserTool.addEventListener('click', () => this.setActiveTool('eraser'));
                
                // Slider Events
                this.brushSizeSlider.addEventListener('input', () => {
                    this.state.brushSize = parseInt(this.brushSizeSlider.value);
                    this.brushSizeValue.textContent = this.state.brushSize;
                });
                this.brushHardnessSlider.addEventListener('input', () => {
                    this.state.brushHardness = parseInt(this.brushHardnessSlider.value);
                    this.brushHardnessValue.textContent = `${this.state.brushHardness}%`;
                });
                this.toleranceSlider.addEventListener('input', () => {
                    this.state.tolerance = parseInt(this.toleranceSlider.value);
                    this.toleranceValue.textContent = `${this.state.tolerance}%`;
                });
                this.contrastSlider.addEventListener('input', () => {
                    this.state.contrast = parseInt(this.contrastSlider.value);
                    this.contrastValue.textContent = `${this.state.contrast}%`;
                });
                this.smoothnessSlider.addEventListener('input', () => {
                    this.state.smoothness = parseInt(this.smoothnessSlider.value);
                    this.smoothnessValue.textContent = `${this.state.smoothness}%`;
                    this.applyEdgeRefinement();
                });
                this.featherSlider.addEventListener('input', () => {
                    this.state.feather = parseInt(this.featherSlider.value);
                    this.featherValue.textContent = `${this.state.feather}%`;
                    this.applyEdgeRefinement();
                });
                this.watermarkOpacitySlider.addEventListener('input', () => {
                    this.state.watermark.opacity = parseInt(this.watermarkOpacitySlider.value);
                    this.watermarkOpacityValue.textContent = `${this.state.watermark.opacity}%`;
                });
                this.watermarkToggle.addEventListener('change', () => {
                    this.state.watermark.enabled = this.watermarkToggle.checked;
                });
                this.watermarkText.addEventListener('input', () => {
                    this.state.watermark.text = this.watermarkText.value || 'ProBG Remover';
                });
                
                // Action Buttons
                this.undoBtn.addEventListener('click', () => this.undo());
                this.redoBtn.addEventListener('click', () => this.redo());
                this.resetBtn.addEventListener('click', () => this.resetImage());
                this.downloadBtn.addEventListener('click', () => this.downloadImage());
                
                // Canvas Events
                this.setupCanvasEvents();
            }
            
            setupPreviewSlider() {
                let isDragging = false;
                
                this.sliderThumb.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    document.addEventListener('mousemove', handleMove);
                    document.addEventListener('mouseup', () => {
                        isDragging = false;
                        document.removeEventListener('mousemove', handleMove);
                    });
                });
                
                this.previewSlider.addEventListener('click', (e) => {
                    const rect = this.previewSlider.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const percent = Math.min(Math.max(x / rect.width, 0), 1);
                    updateSliderPosition(percent);
                });
                
                const handleMove = (e) => {
                    if (!isDragging) return;
                    const rect = this.previewSlider.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const percent = Math.min(Math.max(x / rect.width, 0), 1);
                    updateSliderPosition(percent);
                };
                
                const updateSliderPosition = (percent) => {
                    const thumbPos = percent * 100;
                    this.sliderThumb.style.left = `${thumbPos}%`;
                    
                    // Update canvas visibility based on slider position
                    this.originalCanvas.style.opacity = 1 - percent;
                    this.resultCanvas.style.opacity = percent;
                    this.originalCanvas.style.display = 'block';
                    this.resultCanvas.style.display = 'block';
                };
            }
            
            setupCanvasEvents() {
                // Common variables for drawing
                let isDrawing = false;
                let lastX = 0;
                let lastY = 0;
                
                // Mouse/Touch down event
                const startDrawing = (e) => {
                    if (!this.state.originalImage) return;
                    
                    isDrawing = true;
                    const pos = this.getCanvasPosition(e);
                    lastX = pos.x;
                    lastY = pos.y;
                    
                    // Save state to history before making changes
                    this.saveHistory();
                };
                
                // Mouse/Touch move event
                const draw = (e) => {
                    if (!isDrawing || !this.state.activeTool) return;
                    
                    const pos = this.getCanvasPosition(e);
                    const ctx = this.originalCanvas.getContext('2d');
                    
                    // Draw on the canvas based on active tool
                    switch (this.state.activeTool) {
                        case 'brush':
                        case 'eraser':
                        case 'keep':
                        case 'remove':
                            this.drawBrushStroke(ctx, lastX, lastY, pos.x, pos.y);
                            break;
                    }
                    
                    lastX = pos.x;
                    lastY = pos.y;
                    
                    // Update the result after drawing
                    this.updateResult();
                };
                
                // Mouse/Touch up event
                const stopDrawing = () => {
                    isDrawing = false;
                };
                
                // Add event listeners for mouse
                this.originalCanvas.addEventListener('mousedown', startDrawing);
                this.originalCanvas.addEventListener('mousemove', draw);
                this.originalCanvas.addEventListener('mouseup', stopDrawing);
                this.originalCanvas.addEventListener('mouseout', stopDrawing);
                
                // Add event listeners for touch
                this.originalCanvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    startDrawing(e.touches[0]);
                });
                this.originalCanvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    draw(e.touches[0]);
                });
                this.originalCanvas.addEventListener('touchend', stopDrawing);
            }
            
            getCanvasPosition(e) {
                const rect = this.originalCanvas.getBoundingClientRect();
                const scaleX = this.originalCanvas.width / rect.width;
                const scaleY = this.originalCanvas.height / rect.height;
                
                return {
                    x: (e.clientX - rect.left) * scaleX,
                    y: (e.clientY - rect.top) * scaleY
                };
            }
            
            drawBrushStroke(ctx, x1, y1, x2, y2) {
                // Set brush properties based on active tool
                let color, opacity;
                switch (this.state.activeTool) {
                    case 'keep':
                        color = '#00FF00'; // Green for keep
                        opacity = 0.7;
                        break;
                    case 'remove':
                        color = '#FF0000'; // Red for remove
                        opacity = 0.7;
                        break;
                    case 'brush':
                        color = '#00FF00'; // Green for brush (keep)
                        opacity = 0.5;
                        break;
                    case 'eraser':
                        color = '#FF0000'; // Red for eraser (remove)
                        opacity = 0.5;
                        break;
                    default:
                        return;
                }
                
                // Draw the brush stroke
                ctx.strokeStyle = color;
                ctx.globalAlpha = opacity;
                ctx.lineWidth = this.state.brushSize;
                ctx.lineJoin = 'round';
                ctx.lineCap = 'round';
                
                // For hardness, we can use a gradient or multiple strokes
                // This is a simplified version
                ctx.beginPath();
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.stroke();
                
                // Draw circles at the ends for better appearance
                ctx.beginPath();
                ctx.arc(x1, y1, this.state.brushSize / 2, 0, Math.PI * 2);
                ctx.fillStyle = color;
                ctx.globalAlpha = opacity;
                ctx.fill();
                
                ctx.beginPath();
                ctx.arc(x2, y2, this.state.brushSize / 2, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.globalAlpha = 1.0;
            }
            
            setActiveTool(tool) {
                this.state.activeTool = tool;
                
                // Update UI to show active tool
                this.keepTool.classList.remove('active');
                this.removeTool.classList.remove('active');
                this.brushTool.classList.remove('active');
                this.eraserTool.classList.remove('active');
                
                switch (tool) {
                    case 'keep':
                        this.keepTool.classList.add('active');
                        break;
                    case 'remove':
                        this.removeTool.classList.add('active');
                        break;
                    case 'brush':
                        this.brushTool.classList.add('active');
                        break;
                    case 'eraser':
                        this.eraserTool.classList.add('active');
                        break;
                }
            }
            
            async handleFileUpload(file) {
                // Validate file
                if (!file.type.match('image.*')) {
                    this.showToast('Please upload an image file (PNG, JPG, JPEG)', 'error');
                    return;
                }
                
                if (file.size > 10 * 1024 * 1024) { // 10MB limit
                    this.showToast('File size should be less than 10MB', 'error');
                    return;
                }
                
                this.showLoading('Loading image...');
                
                try {
                    // Load the image
                    const img = await this.loadImage(file);
                    
                    // Show the preview and tools sections
                    this.previewSection.style.display = 'block';
                    this.toolsSection.style.display = 'block';
                    
                    // Set the image in state
                    this.state.originalImage = img;
                    this.state.processedImage = null;
                    this.state.maskData = null;
                    this.state.history = [];
                    this.state.historyIndex = -1;
                    
                    // Draw the image on canvas
                    this.drawOriginalImage();
                    
                    // Initialize mask
                    this.initializeMask();
                    
                    // Hide loading
                    this.hideLoading();
                    
                    // Show success message
                    this.showToast('Image loaded successfully', 'success');
                    
                } catch (error) {
                    console.error('Error loading image:', error);
                    this.hideLoading();
                    this.showToast('Error loading image. Please try another file.', 'error');
                }
            }
            
            loadImage(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image();
                        img.onload = () => resolve(img);
                        img.onerror = reject;
                        img.src = e.target.result;
                    };
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                });
            }
            
            drawOriginalImage() {
                const img = this.state.originalImage;
                const canvas = this.originalCanvas;
                const resultCanvas = this.resultCanvas;
                
                // Calculate dimensions to fit in preview container while maintaining aspect ratio
                const container = this.previewContainer;
                const containerWidth = container.clientWidth;
                const containerHeight = container.clientHeight;
                
                let width = img.width;
                let height = img.height;
                
                // Scale down if necessary
                if (width > containerWidth || height > containerHeight) {
                    const ratio = Math.min(containerWidth / width, containerHeight / height);
                    width *= ratio;
                    height *= ratio;
                }
                
                // Set canvas dimensions
                canvas.width = width;
                canvas.height = height;
                resultCanvas.width = width;
                resultCanvas.height = height;
                this.hiddenCanvas.width = width;
                this.hiddenCanvas.height = height;
                
                // Save canvas size in state
                this.state.canvasSize = { width, height };
                
                // Draw image on canvas
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, width, height);
                
                // Clear result canvas
                const resultCtx = resultCanvas.getContext('2d');
                resultCtx.clearRect(0, 0, width, height);
            }
            
            initializeMask() {
                // Create a blank mask (fully transparent)
                const { width, height } = this.state.canvasSize;
                const ctx = this.hiddenCanvas.getContext('2d');
                ctx.clearRect(0, 0, width, height);
                
                // Perform initial background removal (simplified)
                this.removeBackground();
            }
            
            removeBackground() {
                this.showLoading('Removing background...');
                
                // Simulate background removal with timeout (in a real app, this would use actual algorithms)
                setTimeout(() => {
                    const { originalImage, canvasSize } = this.state;
                    const { width, height } = canvasSize;
                    
                    // Get image data from original canvas
                    const originalCtx = this.originalCanvas.getContext('2d');
                    const imageData = originalCtx.getImageData(0, 0, width, height);
                    const data = imageData.data;
                    
                    // Create mask (simplified algorithm)
                    // In a real implementation, this would use more sophisticated edge detection
                    for (let i = 0; i < data.length; i += 4) {
                        const r = data[i];
                        const g = data[i + 1];
                        const b = data[i + 2];
                        
                        // Simple background detection (assuming light background)
                        const brightness = (r + g + b) / 3;
                        if (brightness > 200) { // Threshold for background
                            data[i + 3] = 0; // Set alpha to 0 (transparent)
                        }
                    }
                    
                    // Put the processed data back
                    originalCtx.putImageData(imageData, 0, 0);
                    
                    // Update the result
                    this.updateResult();
                    
                    // Save to history
                    this.saveHistory();
                    
                    this.hideLoading();
                    this.showToast('Background removed. Use tools to refine edges.', 'success');
                }, 1500);
            }
            
            updateResult() {
                const { width, height } = this.state.canvasSize;
                const originalCtx = this.originalCanvas.getContext('2d');
                const resultCtx = this.resultCanvas.getContext('2d');
                
                // Get the current image data with user edits
                const imageData = originalCtx.getImageData(0, 0, width, height);
                
                // Apply edge refinement
                this.applyEdgeRefinement(imageData);
                
                // Put the processed data to result canvas
                resultCtx.putImageData(imageData, 0, 0);
                
                // Apply watermark if enabled
                if (this.state.watermark.enabled) {
                    this.applyWatermark(resultCtx);
                }
            }
            
            applyEdgeRefinement(imageData) {
                // This would apply edge refinement based on smoothness and feather settings
                // In a real implementation, this would use sophisticated algorithms
                
                // For now, we'll just simulate it
                const smoothness = this.state.smoothness / 100;
                const feather = this.state.feather / 100;
                
                // console.log(`Applying edge refinement: smoothness=${smoothness}, feather=${feather}`);
            }
            
            applyWatermark(ctx) {
                const { width, height } = this.state.canvasSize;
                const watermark = this.state.watermark;
                
                ctx.font = '20px Arial';
                ctx.fillStyle = `rgba(255, 255, 255, ${watermark.opacity / 100})`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(watermark.text, width / 2, height / 2);
            }
            
            saveHistory() {
                // Remove any history after current index (if we're not at the end)
                if (this.state.historyIndex < this.state.history.length - 1) {
                    this.state.history = this.state.history.slice(0, this.state.historyIndex + 1);
                }
                
                // Save current canvas state
                const { width, height } = this.state.canvasSize;
                const ctx = this.originalCanvas.getContext('2d');
                const imageData = ctx.getImageData(0, 0, width, height);
                
                // Add to history
                this.state.history.push(imageData);
                this.state.historyIndex = this.state.history.length - 1;
                
                // Update undo/redo buttons
                this.updateUndoRedoButtons();
            }
            
            undo() {
                if (this.state.historyIndex <= 0) return;
                
                this.state.historyIndex--;
                this.restoreFromHistory();
            }
            
            redo() {
                if (this.state.historyIndex >= this.state.history.length - 1) return;
                
                this.state.historyIndex++;
                this.restoreFromHistory();
            }
            
            restoreFromHistory() {
                const { width, height } = this.state.canvasSize;
                const ctx = this.originalCanvas.getContext('2d');
                const imageData = this.state.history[this.state.historyIndex];
                
                ctx.putImageData(imageData, 0, 0);
                this.updateResult();
                this.updateUndoRedoButtons();
            }
            
            updateUndoRedoButtons() {
                this.undoBtn.disabled = this.state.historyIndex <= 0;
                this.redoBtn.disabled = this.state.historyIndex >= this.state.history.length - 1;
            }
            
            resetImage() {
                if (!this.state.originalImage) return;
                
                // Reset to original image
                this.drawOriginalImage();
                
                // Reinitialize mask
                this.initializeMask();
                
                // Reset history
                this.state.history = [];
                this.state.historyIndex = -1;
                this.updateUndoRedoButtons();
                
                this.showToast('Image reset to original', 'success');
            }
            
            downloadImage() {
                if (!this.state.originalImage) return;
                
                // Create a temporary canvas with the result
                const { width, height } = this.state.canvasSize;
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = width;
                tempCanvas.height = height;
                const tempCtx = tempCanvas.getContext('2d');
                
                // Draw the result
                const resultCtx = this.resultCanvas.getContext('2d');
                const imageData = resultCtx.getImageData(0, 0, width, height);
                tempCtx.putImageData(imageData, 0, 0);
                
                // Apply watermark if enabled
                if (this.state.watermark.enabled) {
                    this.applyWatermark(tempCtx);
                }
                
                // Convert to data URL
                const dataURL = tempCanvas.toDataURL('image/png');
                
                // Create download link
                const link = document.createElement('a');
                link.download = `bg_removed_${Date.now()}.png`;
                link.href = dataURL;
                link.click();
                
                this.showToast('Image downloaded successfully', 'success');
            }
            
            showLoading(message) {
                this.loadingText.textContent = message;
                this.loadingOverlay.classList.add('active');
            }
            
            hideLoading() {
                this.loadingOverlay.classList.remove('active');
            }
            
            showToast(message, type = 'info') {
                this.toast.textContent = message;
                this.toast.className = 'toast';
                this.toast.classList.add(type);
                this.toast.classList.add('show');
                
                setTimeout(() => {
                    this.toast.classList.remove('show');
                }, 3000);
            }
        }
        
        // Helper function for accessibility
        function visuallyHidden() {
            return `
                position: absolute;
                width: 1px;
                height: 1px;
                padding: 0;
                margin: -1px;
                overflow: hidden;
                clip: rect(0, 0, 0, 0);
                white-space: nowrap;
                border-width: 0;
            `;
        }
        
        // Add visually hidden style to head
        const style = document.createElement('style');
        style.textContent = `.visually-hidden { ${visuallyHidden()} }`;
        document.head.appendChild(style);
        
        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            const bgRemover = new BackgroundRemover();
        });
    </script>
</body>
</html>
